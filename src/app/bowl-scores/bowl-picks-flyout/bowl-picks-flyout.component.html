<main>
  <div *ngIf="isAdmin" class="admin-badge">ADMIN VIEW</div>
  
  <div class="flyout-header">
    <h2 class="entry-name">{{ bowlName }} Bowl</h2>
    <div class="game-info">
      <span class="game-time">{{ gameTime | date : "short" }}</span>
    </div>
  </div>

  <!-- Game Summary Section -->
  <div class="summary-section">
    <h3 class="section-title">Point Distribution</h3>
    <div class="summary-content">
      <span class="summary-stat">
        <strong>1 Point:</strong> {{ onePointCount }}
      </span>
      <span class="summary-stat">
        <strong>3 Points:</strong> {{ threePointCount }}
      </span>
      <span class="summary-stat">
        <strong>5 Points:</strong> {{ fivePointCount }}
      </span>
    </div>
  </div>

  <!-- Selection Breakdown Section -->
  <div class="summary-section">
    <h3 class="section-title">Selection Breakdown</h3>
    <div class="summary-content">
      <span class="summary-stat">
        <app-school-logo [schoolName]="team1name" [logoId]="team1logo_id"></app-school-logo>: <strong>{{ team1picks }}</strong> ({{ team1PickPercentage }}%)
      </span>
      <span class="summary-stat">
        <app-school-logo [schoolName]="team2name" [logoId]="team2logo_id"></app-school-logo>: <strong>{{ team2picks }}</strong> ({{ team2PickPercentage }}%)
      </span>
    </div>
    
    <!-- Pie Chart -->
    <div class="pie-chart-container">
      <div class="pie-chart" [style.background]="'conic-gradient(' + team1Color + ' 0deg ' + (team1PickPercentage * 3.6) + 'deg, ' + team2Color + ' ' + (team1PickPercentage * 3.6) + 'deg 360deg)'"></div>
      <div class="pie-legend">
        <div class="legend-item">
          <span class="legend-color" [style.background-color]="team1Color"></span>
          <span>{{ team1name }} ({{ team1PickPercentage }}%)</span>
        </div>
        <div class="legend-item">
          <span class="legend-color" [style.background-color]="team2Color"></span>
          <span>{{ team2name }} ({{ team2PickPercentage }}%)</span>
        </div>
      </div>
    </div>
    
    <!-- Point Value Breakdown Chart -->
    <app-point-breakdown-chart 
      [data]="{ 
        team1Name: team1name, 
        team2Name: team2name, 
        pointDistributionByTeam: pointDistributionByTeam 
      }"
      legendPosition="right">
    </app-point-breakdown-chart>
    <div *ngIf="gameHasResult" class="final-score">
      <h3 class="section-title">Final Score</h3>
      <div class="summary-content">
        <span class="summary-stat">
          <app-school-logo [schoolName]="team1name" [logoId]="team1logo_id"></app-school-logo>: <strong>{{ team1score }}</strong>
        </span>
        <span class="summary-stat">
          <app-school-logo [schoolName]="team2name" [logoId]="team2logo_id"></app-school-logo>: <strong>{{ team2score }}</strong>
        </span>
      </div>
    </div>
  </div>

  <!-- Picks Table -->
  <div class="picks-section">
    <h3 class="section-title">Entries by Current Points</h3>
    
    <div class="table-wrapper">
      <table class="picks-table">
        <thead>
          <tr>
            <th class="entry-col">Entry</th>
            <th class="pick-col">{{ team1name }}</th>
            <th class="pick-col">{{ team2name }}</th>
            <th class="points-col">Points</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let pick of picks; let i = index" [class.alt-row]="i % 2 === 1">
            <td class="entry-col">
              <span class="entry-name">{{ pick.name }}</span>
            </td>
            <td class="pick-col">
              <div class="team-pick-item" *ngIf="pick.team_1_picked">
                <app-status-indicator
                  [value]="pick.correct1"
                  [showCheck]="pick.team_1_picked"
                ></app-status-indicator>
                <app-school-logo [schoolName]="" [logoId]="team1logo_id"></app-school-logo>
              </div>
            </td>
            <td class="pick-col">
              <div class="team-pick-item" *ngIf="pick.team_2_picked">
                <app-status-indicator
                  [value]="pick.correct2"
                  [showCheck]="pick.team_2_picked"
                ></app-status-indicator>
                <app-school-logo [schoolName]="" [logoId]="team2logo_id"></app-school-logo>
              </div>
            </td>
            <td class="points-col">
              <span *ngIf="!pick.earned_points" class="pending-points">{{ pick.points }}</span>
              <span *ngIf="pick.earned_points" class="earned-points">{{ pick.earned_points }}</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</main>

